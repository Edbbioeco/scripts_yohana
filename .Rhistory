dplyr::rename("Species" = Espécies)
comp_trat
comp_flex <- comp_trat |>
flextable::flextable() |>
flextable::align(align = "center", part = "all") |>
flextable::width(width = 2.5, j = 1) |>
flextable::italic(j = 1) |>
flextable::italic(j = 1, i = c(1, 6, 8, 23, 31, 34), italic = FALSE) |>
flextable::bold(i = c(1, 6, 8, 23, 31, 34)) |>
flextable::bg(bg = "white", part = "all")
comp_flex
comp_flex <- comp_trat |>
flextable::flextable() |>
flextable::align(align = "center", part = "all") |>
flextable::width(width = 2.5, j = 1) |>
flextable::italic(j = 1) |>
flextable::italic(j = 1, i = c(1, 6, 8, 10, 23, 31, 34), italic = FALSE) |>
flextable::bold(i = c(1, 6, 8, 23, 31, 34)) |>
flextable::bg(bg = "white", part = "all")
comp_flex
comp_flex <- comp_trat |>
flextable::flextable() |>
flextable::align(align = "center", part = "all") |>
flextable::width(width = 2.5, j = 1) |>
flextable::italic(j = 1) |>
flextable::italic(j = 1, i = c(1, 6, 8, 10, 23, 31, 34), italic = FALSE) |>
flextable::bold(i = c(1, 6, 8, 23, 31, 34)) |>
flextable::bg(bg = "white", part = "all")
comp_flex
comp_trat |>
flextable::flextable() |>
flextable::align(align = "center", part = "all") |>
flextable::width(width = 2.5, j = 1) |>
flextable::italic(j = 1) |>
flextable::italic(j = 1, i = c(1, 6, 8, 10, 23, 31, 34), italic = FALSE) |>
flextable::bold(i = c(1, 6, 8, 23, 31, 34))
comp_flex <- comp_trat |>
flextable::flextable() |>
flextable::align(align = "center", part = "all") |>
flextable::width(width = 2.5, j = 1) |>
flextable::italic(j = 1) |>
flextable::italic(j = 1, i = c(1, 6, 8, 10, 23, 31, 34), italic = FALSE) |>
flextable::bold(i = c(1, 6, 8, 10, 23, 31, 34)) |>
flextable::bg(bg = "white", part = "all")
comp_flex
comp_flex <- comp_trat |>
flextable::flextable() |>
flextable::align(align = "center", part = "all") |>
flextable::width(width = 2.5, j = 1) |>
flextable::italic(j = 1) |>
flextable::italic(j = 1, i = c(1, 6, 8, 10, 25, 32, 35), italic = FALSE) |>
flextable::bold(i = c(1, 6, 8, 10, 25, 32, 35)) |>
flextable::bg(bg = "white", part = "all")
comp_flex
comp_flex |>
flextable::save_as_docx(path = "dissertacao_tabela_especies.docx")
comp_flex |>
flextable::save_as_image(path = "dissertacao_tabela_especies.png")
comp_flex |>
flextable::save_as_docx(path = "dissertacao_tabela_especies.docx")
comp
comp |>
tidyr::pivot_longer(cols = dplyr::where(is.numeric),
names_to = "Local",
values_to = "Abundância")
comp |>
tidyr::pivot_longer(cols = dplyr::where(is.numeric),
names_to = "Local",
values_to = "Abundância") |>
dplyr::summarise(Abundância = Abundância |> sum(),
.by = Species)
comp |>
tidyr::pivot_longer(cols = dplyr::where(is.numeric),
names_to = "Local",
values_to = "Abundância") |>
dplyr::summarise(Abundância = Abundância |> sum(),
.by = Espécies)
comp |>
tidyr::pivot_longer(cols = dplyr::where(is.numeric),
names_to = "Local",
values_to = "Abundância") |>
dplyr::summarise(Abundância = Abundância |> sum(),
.by = Espécies) |>
dplyr::arrange(Abundância |> dplyr::desc())
source("~/yohana/dissertacao_especies_indice_constancia.R", echo = TRUE)
source("~/yohana/dissertacao_especies_indice_constancia.R", echo = TRUE)
c_i |> as.data.frame()
c_i_trat <- c_i |>
tibble::add_row(Espécies = "Bufonidae",
CI = NULL, Category = NULL,
.before = 1) |>
tibble::add_row(Espécies = "Centrolenidae",
CI = NULL, Category = NULL,
.before = 6) |>
tibble::add_row(Espécies = "Craugastoridae",
CI = NULL, Category = NULL,
.before = 8) |>
tibble::add_row(Espécies = "Hylidae",
CI = NULL, Category = NULL,
.before = 10) |>
tibble::add_row(Espécies = "Leptodactylidae",
CI = NULL, Category = NULL,
.before = 25) |>
tibble::add_row(Espécies = "Microhylidae",
CI = NULL, Category = NULL,
.before = 32) |>
tibble::add_row(Espécies = "Odontophrynidae",
CI = NULL, Category = NULL,
.before = 35) |>
dplyr::rename("Species" = Espécies)
c_i_trat <- c_i |>
tibble::add_row(Espécies = "Bufonidae",
CI = NULL, Category = NULL,
.before = 1) |>
tibble::add_row(Espécies = "Centrolenidae",
CI = NULL, Category = NULL,
.before = 6) |>
tibble::add_row(Espécies = "Craugastoridae",
CI = NULL, Category = NULL,
.before = 8) |>
tibble::add_row(Espécies = "Hylidae",
CI = NULL, Category = NULL,
.before = 10) |>
tibble::add_row(Espécies = "Leptodactylidae",
CI = NULL, Category = NULL,
.before = 25) |>
tibble::add_row(Espécies = "Microhylidae",
CI = NULL, Category = NULL,
.before = 32) |>
tibble::add_row(Espécies = "Odontophrynidae",
CI = NULL, Category = NULL,
.before = 35)
c_i_trat
c_i_trat <- c_i |>
tibble::add_row(Espécies = "Bufonidae",
CI = NULL, Category = NULL,
.before = 1) |>
tibble::add_row(Espécies = "Centrolenidae",
CI = NULL, Category = NULL,
.before = 6) |>
tibble::add_row(Espécies = "Craugastoridae",
CI = NULL, Category = NULL,
.before = 8) |>
tibble::add_row(Espécies = "Hylidae",
CI = NULL, Category = NULL,
.before = 10) |>
tibble::add_row(Espécies = "Leptodactylidae",
CI = NULL, Category = NULL,
.before = 25) |>
tibble::add_row(Espécies = "Microhylidae",
CI = NULL, Category = NULL,
.before = 32) |>
tibble::add_row(Espécies = "Odontophrynidae",
CI = NULL, Category = NULL,
.before = 35)
c_i_trat <- c_i |>
tibble::add_row(Species = "Bufonidae",
CI = NULL, Category = NULL,
.before = 1) |>
tibble::add_row(Species = "Centrolenidae",
CI = NULL, Category = NULL,
.before = 6) |>
tibble::add_row(Species = "Craugastoridae",
CI = NULL, Category = NULL,
.before = 8) |>
tibble::add_row(Species = "Hylidae",
CI = NULL, Category = NULL,
.before = 10) |>
tibble::add_row(Species = "Leptodactylidae",
CI = NULL, Category = NULL,
.before = 25) |>
tibble::add_row(Species = "Microhylidae",
CI = NULL, Category = NULL,
.before = 32) |>
tibble::add_row(Species = "Odontophrynidae",
CI = NULL, Category = NULL,
.before = 35)
c_i_trat
c_1_flex <- c_i_trat |>
flextable::flextable() |>
flextable::align(align = "center", part = "all") |>
flextable::width(width = 2.5, j = 1) |>
flextable::italic(j = 1) |>
flextable::italic(j = 1, i = c(1, 6, 8, 10, 25, 32, 35), italic = FALSE) |>
flextable::bold(i = c(1, 6, 8, 10, 25, 32, 35)) |>
flextable::bg(bg = "white", part = "all")
c_1_flex
c_1_flex |>
flextable::save_as_docx(path = "dissertacao_tabela_ci.docx")
c_1_flex |>
flextable::save_as_image(path = "dissertacao_tabela_ci.png")
c_i <- comp |>
dplyr::summarise(CI = sum(Abundância > 0) / n(),
.by = Espécies) |>
dplyr::mutate(Category = dplyr::case_when(dplyr::between(CI, 0, 0.25) ~ "Accidental",
dplyr::between(CI, 0.251, 0.5) ~ "Accessory",
dplyr::between(CI, 0.51, 1) ~ "Constant"),
CI = CI * 100) |>
dplyr::rename("Species" = Espécies)
c_i |> as.data.frame()
c_i <- comp |>
dplyr::summarise(CI = sum(Abundância > 0) / n(),
.by = Espécies) |>
dplyr::mutate(Category = dplyr::case_when(dplyr::between(CI, 0, 0.25) ~ "Accidental",
dplyr::between(CI, 0.251, 0.5) ~ "Accessory",
dplyr::between(CI, 0.51, 1) ~ "Constant"),
CI = paste0(CI * 100, " %")) |>
dplyr::rename("Species" = Espécies)
c_i |> as.data.frame()
c_i_trat <- c_i |>
tibble::add_row(Species = "Bufonidae",
CI = NULL, Category = NULL,
.before = 1) |>
tibble::add_row(Species = "Centrolenidae",
CI = NULL, Category = NULL,
.before = 6) |>
tibble::add_row(Species = "Craugastoridae",
CI = NULL, Category = NULL,
.before = 8) |>
tibble::add_row(Species = "Hylidae",
CI = NULL, Category = NULL,
.before = 10) |>
tibble::add_row(Species = "Leptodactylidae",
CI = NULL, Category = NULL,
.before = 25) |>
tibble::add_row(Species = "Microhylidae",
CI = NULL, Category = NULL,
.before = 32) |>
tibble::add_row(Species = "Odontophrynidae",
CI = NULL, Category = NULL,
.before = 35)
c_i_trat
c_i <- comp |>
dplyr::summarise(CI = sum(Abundância > 0) / n(),
.by = Espécies) |>
dplyr::mutate(Category = dplyr::case_when(dplyr::between(CI, 0, 0.25) ~ "Accidental",
dplyr::between(CI, 0.251, 0.5) ~ "Accessory",
dplyr::between(CI, 0.51, 1) ~ "Constant"),
CI = paste0(CI * 100, "%")) |>
dplyr::rename("Species" = Espécies)
c_i |> as.data.frame()
c_i_trat <- c_i |>
tibble::add_row(Species = "Bufonidae",
CI = NULL, Category = NULL,
.before = 1) |>
tibble::add_row(Species = "Centrolenidae",
CI = NULL, Category = NULL,
.before = 6) |>
tibble::add_row(Species = "Craugastoridae",
CI = NULL, Category = NULL,
.before = 8) |>
tibble::add_row(Species = "Hylidae",
CI = NULL, Category = NULL,
.before = 10) |>
tibble::add_row(Species = "Leptodactylidae",
CI = NULL, Category = NULL,
.before = 25) |>
tibble::add_row(Species = "Microhylidae",
CI = NULL, Category = NULL,
.before = 32) |>
tibble::add_row(Species = "Odontophrynidae",
CI = NULL, Category = NULL,
.before = 35)
c_i_trat
c_1_flex <- c_i_trat |>
flextable::flextable() |>
flextable::align(align = "center", part = "all") |>
flextable::width(width = 2.5, j = 1) |>
flextable::italic(j = 1) |>
flextable::italic(j = 1, i = c(1, 6, 8, 10, 25, 32, 35), italic = FALSE) |>
flextable::bold(i = c(1, 6, 8, 10, 25, 32, 35)) |>
flextable::bg(bg = "white", part = "all")
c_1_flex
c_1_flex |>
flextable::save_as_docx(path = "dissertacao_tabela_ci.docx")
c_1_flex |>
flextable::save_as_image(path = "dissertacao_tabela_ci.png")
c_1_flex <- c_i_trat |>
flextable::flextable() |>
flextable::align(align = "center", part = "all") |>
flextable::width(width = 2.5, j = c(1, 3)) |>
flextable::italic(j = 1) |>
flextable::italic(j = 1, i = c(1, 6, 8, 10, 25, 32, 35), italic = FALSE) |>
flextable::bold(i = c(1, 6, 8, 10, 25, 32, 35)) |>
flextable::bg(bg = "white", part = "all")
c_1_flex
c_1_flex |>
flextable::save_as_docx(path = "dissertacao_tabela_ci.docx")
c_1_flex |>
flextable::save_as_image(path = "dissertacao_tabela_ci.png")
c_i_trat
c_i
c_i |>
dplyr::summarise(Quantidade = n(),
.by = Category)
c_i |>
dplyr::summarise(Quantidade = n(),
Porcentagem = n() / nrow(),
.by = Category)
c_i |>
dplyr::summarise(Quantidade = n(),
Porcentagem = n() / nrow(.),
.by = Category)
c_i |>
dplyr::summarise(Quantidade = n(),
Porcentagem = n() / 31,
.by = Category)
c_i |>
dplyr::summarise(Quantidade = n(),
Porcentagem = (n() / 31) |> round(2),
.by = Category)
source("analises_consultoria_11.2025.R")
ls()
ls() |>
mget(envir = globalenv())
ls()
ramos
ramos
Área
dados_curva
ramos
dados_curva
dados_curva |>
writexl::write_xlsx("valores_riqueza.curva.xlsx")
matriz_whit
dados_curva |>
writexl::write_xlsx("valores_riqueza_curva.xlsx")
matriz_whit |>
writexl::write_xlsx("valores_riqueza_diagrama_whitaker.xlsx")
ramos
Área
ramos |>
writexl::write_xlsx("valores_similaridade_dendograma.xlsx")
library(readxl)
library(tidyverse)
library(vegan)
library(ggdendro)
library(ggview)
library(flextable)
dados <- readxl::read_xlsx("Dados.xlsx")
dados
dados |> dplyr::glimpse()
matriz <- dados |>
dplyr::mutate(Especies = Especies |> stringr::str_replace("_", " ")) |>
dplyr::summarise(Abundancia = Abundancia |> max(),
.by = c(Especies, Área)) |>
tidyr::pivot_wider(names_from = Especies,
values_from = Abundancia,
values_fill = 0) |>
tibble::column_to_rownames(var = "Área")
matriz
matriz_temp <- dados |>
dplyr::summarise(Abundancia = Abundancia |> max(),
.by = c(Especies, Data)) |>
tidyr::pivot_wider(names_from = Especies,
values_from = Abundancia,
values_fill = 0)
matriz_temp
temp <- dados |>
dplyr::mutate(`Horário e data` = paste0(Data, " ", Hora) |>
lubridate::as_datetime())
temp |> dplyr::glimpse()
matriz_whit <- dados |>
dplyr::mutate(Especies = Especies |> stringr::str_replace("_", " ")) |>
dplyr::summarise(Abundancia = Abundancia |> max(),
.by = c(Especies, Área)) |>
dplyr::arrange(Área, Abundancia |> desc()) |>
dplyr::mutate(Rank = dplyr::row_number(),
.by = Área)
matriz_whit
bray <- 1 - matriz |> vegan::vegdist()
bray
upgma <- bray |>
hclust(method = "average")
upgma
upgma_data <- upgma |>
as.dendrogram() |>
ggdendro::dendro_data()
upgma_data
ramos <- upgma_data$segments
ramos
Área <- upgma_data$label
Área
ggplot() +
geom_segment(data = ramos, aes(x = x, y = y,
xend = xend, yend = yend),
linewidth = 2) +
labs(x = NULL,
y = "Similaridade de Bray-Curtis") +
scale_x_continuous(breaks = 1:3,
labels = Área$label) +
scale_y_continuous(limits = c(0, 0.38), expand = FALSE) +
theme_minimal() +
theme(axis.text.x = element_text(vjust = 0,
color = "black", size = 25),
axis.text = element_text(color = "black", size = 25),
axis.title = element_text(color = "black", size = 25),
panel.grid.major.y = element_line(linewidth = 1, color = "gray80"),
panel.grid.minor.y = element_blank(),
panel.grid.major.x = element_blank(),
panel.grid.minor.x = element_blank()) +
ggview::canvas(height = 10, width = 12)
ggsave(filename = "upgma.png", height = 10, width = 12)
chao1 <- matriz_temp |>
vegan::estaccumR() |>
summary(display = c("S", "chao"))
chao1
dados_curva <- chao1$S |>
tibble::as_tibble() |>
dplyr::rename("Riqueza" = S,
"Número de dias" = N) |>
dplyr::mutate(Tipo = "Observada") |>
dplyr::bind_rows(chao1$chao |>
tibble::as_tibble() |>
dplyr::rename("Riqueza" = Chao,
"Número de dias" = N) |>
dplyr::mutate(Tipo = "Estimada"))
dados_curva
dados_curva |>
ggplot(aes(`Número de dias`, Riqueza, color = Tipo, fill = Tipo)) +
geom_ribbon(aes(x = `Número de dias`,
ymin = Riqueza - Std.Dev,
ymax = Riqueza + Std.Dev),
alpha = 0.3,
color = "transparent") +
geom_line(linewidth = 1) +
geom_point(color = "black", size = 5, shape = 21) +
scale_color_manual(values = c("royalblue", "orange")) +
scale_fill_manual(values = c("royalblue", "orange")) +
scale_x_continuous(breaks = seq(1, 6, 1)) +
labs(fill = NULL,
color = NULL) +
theme_classic() +
theme(axis.text = element_text(color = "black", size = 25),
axis.title = element_text(color = "black", size = 25),
legend.text = element_text(color = "black", size = 25),
legend.position = "bottom") +
ggview::canvas(height = 10, width = 12)
ggsave(filename = "curva_de_rarefacao.png", height = 10, width = 12)
shanon <- matriz |>
vegan::diversity()
shannon <- matriz |>
vegan::diversity()
shann
shannon
simpson <- matriz |>
vegan::diversity(index = "simpson")
simpson <- matriz |>
vegan::diversity(index = "simpson")
simpson
pielou <- shannon / log(matriz |> vegan::specnumber())
pielou
pielou <- shannon / log(matriz |> vegan::specnumber())
pielou
riq <- matriz |> vegan::specnumber()
riq <- matriz |> vegan::specnumber()
riq
div_df <- tibble::tibble(Riqueza = riq,
`Shannon-Wiener` = shannon,
`Gini-Simpson` = simpson,
`Equitabilidade de Pielou` = pielou)
div_df
div_df <- tibble::tibble(Área = matriz |> rownames(),
Riqueza = riq,
`Shannon-Wiener` = shannon,
`Gini-Simpson` = simpson,
`Equitabilidade de Pielou` = pielou)
div_df
div_df |>
flextable::flextable()
div_df |>
flextable::flextable() |>
flextable::align(align = "center", part = "all") |>
flextable::width(width = 1.75, j = 4) |>
flextable::bg(bg = "white", part = "all")
div_df |>
flextable::flextable() |>
flextable::align(align = "center", part = "all") |>
flextable::width(width = 1.75, j = 3:5) |>
flextable::bg(bg = "white", part = "all")
div_df <- tibble::tibble(Área = matriz |> rownames(),
Riqueza = riq |> round(2),
`Shannon-Wiener` = shannon |> round(2),
`Gini-Simpson` = simpson |> round(2),
`Equitabilidade de Pielou` = pielou |> round(2))
div_df
div_df |>
flextable::flextable() |>
flextable::align(align = "center", part = "all") |>
flextable::width(width = 1.75, j = 3:5) |>
flextable::bg(bg = "white", part = "all")
div_df |>
flextable::flextable() |>
flextable::align(align = "center", part = "all") |>
flextable::width(width = 1.5, j = 3:5) |>
flextable::bg(bg = "white", part = "all")
div_dfdi_flex <- v_df |>
flextable::flextable() |>
flextable::align(align = "center", part = "all") |>
flextable::width(width = 1.5, j = 3:5) |>
flextable::bg(bg = "white", part = "all")
div_df_flex <- div_df |>
flextable::flextable() |>
flextable::align(align = "center", part = "all") |>
flextable::width(width = 1.5, j = 3:5) |>
flextable::bg(bg = "white", part = "all")
div_dfdi_flex
div_df_flex
div_df_flex |>
flextable::save_as_docx(path = "tabela_diversidade_novo.dox")
div_df_flex |>
flextable::save_as_docx(path = "tabela_diversidade_novo.docx")
